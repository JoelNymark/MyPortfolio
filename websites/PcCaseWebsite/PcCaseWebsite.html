<!doctype html>
<html>
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
        <link rel="icon" type="image/png" href="img/favCon144.png"/>
        <title>pc Case</title>
        <link rel="stylesheet" href="../../model.css">
    </head>
    
    <body>
        <model-viewer id="color" alt="pc case" src="../../js/models/pcCase/New case.gltf" poster="img/Mudguard.PNG" shadow-intensity="5" camera-controls>
            <div class="controls" ,="" id="color-controls">
                <button data-color="0.4,0,.3,0.4">Red</button>
                <button data-color="0,0.1,0,0.1">Green</button>
                <button data-color="0,0,0.4,0.4">Blue</button>
                <div class="controls">
                    <div>
                      <p>Metalness: <span id="metalness-value"></span></p>
                      <input id="metalness" type="range" min="0" max="1" step="0.01" value="1">
                    </div>
                    <div>
                      <p>Roughness: <span id="roughness-value"></span></p>
                      <input id="roughness" type="range" min="0" max="1" step="0.01" value="0.5">
                    </div>
                  </div>
            </div>  
        </model-viewer>
        <!-- Loads model-viewer for modern browsers -->
        <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.js"></script>
        <script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"></script>
        <script>
            const modelViewerColor = document.querySelector("model-viewer#color");
            
            document.querySelector('#color-controls').addEventListener('click', (event) => {
              const colorString = event.target.dataset.color;
            
              if (!colorString) {
                return;
              }
            
              const color = colorString.split(',')
                  .map(numberString => parseFloat(numberString));
            
              console.log('Changing color to: ', color);
              const [material] = modelViewerColor.model.materials;
              material.pbrMetallicRoughness.setBaseColorFactor(color);
            });


            const modelViewerParameters = document.querySelector("model-viewer#color");

            modelViewerParameters.addEventListener("load", (ev) => {

            let material = modelViewerParameters.model.materials[0];

            let metalnessDisplay = document.querySelector("#metalness-value");
            let roughnessDisplay = document.querySelector("#roughness-value");

            metalnessDisplay.textContent = material.pbrMetallicRoughness.metallicFactor;
            roughnessDisplay.textContent = material.pbrMetallicRoughness.roughnessFactor;

            // Defaults to gold
            material.pbrMetallicRoughness.setBaseColorFactor([0.7294, 0.5333, 0.0392]);
            material.pbrMetallicRoughness.setRoughnessFactor([0.5, 0.5, 0.5]);

            document.querySelector('#metalness').addEventListener('input', (event) => {
                material.pbrMetallicRoughness.setMetallicFactor(event.target.value);
                metalnessDisplay.textContent = event.target.value;
            });

            document.querySelector('#roughness').addEventListener('input', (event) => {
                material.pbrMetallicRoughness.setRoughnessFactor(event.target.value);
                roughnessDisplay.textContent = event.target.value;
            });
            });
            </script>
    </body>
</html>